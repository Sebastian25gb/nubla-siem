{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "ncs://schema/ncs_v1",
  "title": "Nubla Common Schema (NCS) v1",
  "description": "JSON Schema local para validaci√≥n de eventos NCS v1.",
  "type": "object",
  "required": ["tenant_id", "@timestamp", "dataset", "message", "schema_version", "severity"],
  "properties": {
    "tenant_id": { "type": "string" },
    "@timestamp": { "type": "string", "format": "date-time" },
    "dataset": { "type": "string" },
    "schema_version": { "type": "string" },
    "message": { "type": "string" },
    "category": { "type": "string" },
    "severity": {
      "type": "string",
      "enum": ["low","medium","high","critical","info"]
    },
    "source": {
      "type": "object",
      "properties": {
        "ip": { "type": "string", "format": "ipv4" },
        "port": { "type": "integer" },
        "host": { "type": "string" }
      },
      "additionalProperties": true
    },
    "destination": {
      "type": "object",
      "properties": {
        "ip": { "type": "string", "format": "ipv4" },
        "port": { "type": "integer" },
        "host": { "type": "string" }
      },
      "additionalProperties": true
    },
    "user": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "email": { "type": "string", "format": "email" }
      },
      "additionalProperties": true
    },
    "labels": {
      "type": "object",
      "additionalProperties": { "type": "string" }
    },
    "original": {
      "type": "object",
      "additionalProperties": true
    }
  },
  "additionalProperties": true
}