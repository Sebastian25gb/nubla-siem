# ===============================
# Nubla SIEM – Environment Example
# Copia este archivo a `.env` y ajusta valores según tu entorno.
# NUNCA subas tu `.env` real al repositorio.
# ===============================

#################################
# MODO DE EJECUCIÓN
# Ajusta las direcciones según corras en Docker Compose o local host.
# Para Docker Compose: usa nombres de servicio (rabbitmq, opensearch).
# Para ejecución directa en host (sin Compose): normalmente 127.0.0.1 y puertos publicados.
#################################

# OpenSearch (sin seguridad, dev)
OPENSEARCH_HOST=opensearch:9200

# RabbitMQ (dev)
RABBITMQ_HOST=rabbitmq
RABBITMQ_USER=admin
RABBITMQ_PASSWORD=securepass
RABBITMQ_EXCHANGE=logs_default
RABBITMQ_QUEUE=nubla_logs_default
RABBITMQ_ROUTING_KEY=nubla.log.default
RABBITMQ_DLX=logs_default.dlx
# Dead-letter manual (true/false)
USE_MANUAL_DLX=false

# Enforce strict tenant requirement in consumer (set true to reject events missing tenant_id)
REQUIRE_TENANT=false
# Aplicación / comportamiento general
TENANT_ID=default
LOG_LEVEL=INFO
METRICS_PORT=9109

# Schema NCS (usa la versión incluida)
NCS_SCHEMA_LOCAL_PATH=backend/app/schema/ncs_v1.0.0.json

#################################
# BULK INGEST CONFIG
# USE_BULK=true activa el buffer en memoria.
# BULK_MAX_ITEMS: flush si se alcanza esta cantidad.
# BULK_MAX_INTERVAL_MS: flush si pasa este tiempo sin flush previo.
# CONSUMER_PREFETCH: mensajes máximos pendientes antes de ack (ajusta con bulk).
#################################
USE_BULK=false
BULK_MAX_ITEMS=500
BULK_MAX_INTERVAL_MS=1000
CONSUMER_PREFETCH=5

#################################
# OpenSearch Security (si habilitas el plugin más adelante)
# Descomenta y ajusta:
# OS_USER=admin
# OS_PASS=admin
#################################

#################################
# Variables Legacy (solo si algo antiguo las requiere)
# ELASTICSEARCH_HOST=opensearch:9200
# FEATURE_USE_OPENSEARCH=true
#################################

#################################
# Tips:
# - Cambia OPENSEARCH_HOST a http://localhost:9201 si usas host y has publicado el puerto.
# - Ajusta RABBITMQ_HOST a 127.0.0.1 si pruebas fuera de Docker y el puerto 5672 está expuesto.
# - No dejes USE_BULK=true en producción sin monitoreo (riesgo de pérdida si crash antes del flush final).
#################################